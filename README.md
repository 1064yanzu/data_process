# 情感分析助手

基于 SnowNLP 的智能情感分析系统，支持 LLM 辅助标注、自定义模型训练和效果评估。

## 主要功能

### 🏷️ 数据标注
- **LLM 辅助标注**：使用大语言模型提供情感标注建议
- **人工标注**：支持人工审核和修正标注结果
- **批量处理**：支持批量导入和导出标注数据
- **实时预览**：即时查看标注效果和统计信息

### 🤖 模型训练
- **自定义训练**：基于标注数据训练专业领域模型
- **多种算法**：支持朴素贝叶斯、SVM、逻辑回归等算法
- **参数调优**：可调整特征数量、N-gram 范围等参数
- **训练监控**：实时显示训练进度和状态

### 📊 效果评估
- **性能对比**：对比自定义模型与 SnowNLP 基线性能
- **多维度指标**：准确率、精确率、召回率、F1 分数等
- **可视化分析**：雷达图、柱状图、混淆矩阵等图表
- **详细分析**：查看具体预测结果和错误案例

### 🎨 现代化界面
- **响应式设计**：适配各种屏幕尺寸
- **美观界面**：现代化 UI 设计，提升用户体验
- **实时反馈**：Toast 通知、进度条等交互元素
- **数据可视化**：丰富的图表和统计展示

## 技术栈

### 后端
- **Flask**：Web 框架
- **SnowNLP**：中文情感分析库
- **scikit-learn**：机器学习算法
- **pandas/numpy**：数据处理
- **matplotlib/seaborn**：数据可视化

### 前端
- **Bootstrap 5**：响应式 UI 框架
- **Chart.js**：图表库
- **Font Awesome**：图标库
- **原生 JavaScript**：交互逻辑

### LLM 集成
- **OpenAI API**：支持 GPT 系列模型
- **国产 LLM**：预留百度千帆、阿里通义等接口

## 快速开始

### 1. 环境准备

确保已安装 Python 3.8+：

```bash
python --version
```

### 2. 安装依赖

```bash
# 克隆项目（如果从 git 仓库）
# git clone <repository-url>
# cd sentiment-analysis

# 安装依赖包
pip install -r requirements.txt
```

### 3. 配置环境变量

```bash
# 复制配置文件
cp config.env.example .env

# 编辑配置文件，填写 API 密钥
# 注意：LLM API 配置是可选的，没有配置时会使用 SnowNLP 作为后备
```

### 4. 启动应用

```bash
python app.py
```

应用将在 `http://localhost:5000` 启动。

## 使用指南

### 数据标注流程

1. **添加文本数据**
   - 在"数据标注"页面输入要分析的中文文本
   - 可选择"获取 LLM 建议"或"手动添加"

2. **LLM 辅助标注**
   - 系统会调用配置的 LLM API 分析情感倾向
   - 显示建议结果、置信度和 SnowNLP 对比
   - 可以接受建议或手动修正

3. **管理标注数据**
   - 查看已标注数据列表
   - 支持搜索、过滤、编辑、删除
   - 导出标注结果为 JSON 格式

### 模型训练流程

1. **检查训练数据**
   - 确保至少有 10 条已标注数据
   - 查看数据分布和平衡度
   - 观察文本长度分布

2. **配置训练参数**
   - 选择训练/测试分割比例
   - 选择模型算法类型
   - 设置特征数量和 N-gram 范围

3. **开始训练**
   - 点击"开始训练"按钮
   - 观察训练进度
   - 查看训练结果和建议

### 效果评估流程

1. **运行评估**
   - 在"效果评估"页面点击"重新评估"
   - 系统会自动对比自定义模型和 SnowNLP

2. **查看性能指标**
   - 对比准确率、精确率、召回率、F1 分数
   - 查看性能提升百分比
   - 分析雷达图和柱状图

3. **详细分析**
   - 查看混淆矩阵
   - 分析具体预测结果
   - 识别模型分歧案例
   - 导出评估报告

## 配置说明

### LLM API 配置

#### OpenAI
```env
OPENAI_API_KEY=your_api_key
OPENAI_BASE_URL=https://api.openai.com/v1
```

#### 百度千帆（待实现）
```env
QIANFAN_ACCESS_KEY=your_access_key
QIANFAN_SECRET_KEY=your_secret_key
```

#### 阿里通义千问（待实现）
```env
DASHSCOPE_API_KEY=your_api_key
```

### 模型参数调优

- **训练/测试分割**：建议 80/20 或 70/30
- **最大特征数**：1000-20000，根据数据量调整
- **N-gram 范围**：1-2 适合大多数场景
- **模型算法**：朴素贝叶斯适合文本分类

## 项目结构

```
情感分析/
├── app.py              # 主应用文件
├── requirements.txt    # 依赖包列表
├── config.env.example  # 配置文件示例
├── README.md          # 项目说明
├── 项目文档.md         # 详细技术文档
├── templates/         # HTML 模板
│   ├── base.html      # 基础模板
│   ├── index.html     # 主页
│   ├── annotate.html  # 数据标注页
│   ├── train.html     # 模型训练页
│   └── evaluate.html  # 效果评估页
├── static/           # 静态资源（自动创建）
├── sentiment_data.json    # 标注数据文件（自动创建）
├── trained_model.pkl      # 训练模型文件（自动创建）
└── evaluation_results.json # 评估结果文件（自动创建）
```

## 常见问题

### Q: LLM API 调用失败怎么办？
A: 系统会自动降级使用 SnowNLP 作为后备方案，不影响基本功能。

### Q: 训练数据不足怎么办？
A: 至少需要 10 条已标注数据才能训练模型，建议收集更多数据以提高效果。

### Q: 如何提高模型性能？
A: 
1. 增加标注数据量
2. 保证数据分布平衡
3. 调整模型参数
4. 使用领域相关的文本数据

### Q: 支持其他语言吗？
A: 目前主要针对中文优化，其他语言需要修改分词和预处理逻辑。

## 技术支持

如果遇到问题或有改进建议，请：

1. 检查控制台错误信息
2. 确认环境配置正确
3. 查看项目文档
4. 提交 Issue 或联系开发者

## 更新日志

### v1.0.0
- 基础功能实现
- LLM 辅助标注
- 模型训练和评估
- 现代化 Web 界面

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。 